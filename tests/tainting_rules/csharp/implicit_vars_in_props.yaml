
rules:
- id: taint_prop_field
  languages: [csharp]
  message: "tainted field reaches sink"
  severity: WARNING
  mode: taint
  pattern-sources:
    - patterns:
      - pattern-inside: |
          [get] $T $F($FIELD) { ... }
      - focus-metavariable: $FIELD
      - metavariable-regex:
          metavariable: $FIELD
          regex: field
    - patterns:
      - pattern-inside: |
          [set] $T $F($VALUE, $FIELD) { ... }
      - focus-metavariable: $FIELD
      - metavariable-regex:
          metavariable: $FIELD
          regex: field
  pattern-sinks:
    - pattern: |
        sink(...)

- id: taint_prop_value
  languages: [csharp]
  message: "tainted values reaches sink"
  severity: WARNING
  mode: taint
  pattern-sources:
    - patterns:
      - pattern-inside: |
          [set] $T $F($VALUE, $FIELD) { ... }
      - focus-metavariable: $VALUE
      - metavariable-regex:
          metavariable: $VALUE
          regex: value
  pattern-sinks:
    - pattern: |
        sink(...)

- id: taint_prop_value_no_field
  languages: [csharp]
  message: "tainted values reaches sink"
  severity: WARNING
  mode: taint
  pattern-sources:
    - patterns:
      - pattern-inside: |
          [set] $T $F($VALUE) { ... }
      - focus-metavariable: $VALUE
      - metavariable-regex:
          metavariable: $VALUE
          regex: value
  pattern-sinks:
    - pattern: |
        sink(...)
